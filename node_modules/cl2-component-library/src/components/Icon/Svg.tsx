import React, { memo } from 'react';
import { isBoolean } from 'lodash';
import Box, {
  BoxPositionProps,
  BoxMarginProps,
  BoxPaddingProps,
  BoxVisibilityProps,
  BoxDisplayProps,
  BoxZIndexProps,
} from '../Box';

type Props = {
  className?: string;
  children: JSX.Element | JSX.Element[];
  name: string;
  // if ariaHidden is not specified (or false), a title is 'required' (for a11y)
  title?: string | JSX.Element;
  viewBox?: string;
  fill?: string;
  ariaHidden?: boolean;
  height?: string;
  width?: string;
} & BoxPositionProps &
  BoxMarginProps &
  BoxPaddingProps &
  BoxVisibilityProps &
  BoxDisplayProps &
  BoxZIndexProps;

const Svg = memo(
  ({
    className,
    children,
    name,
    title,
    viewBox,
    fill,
    ariaHidden,
    height,
    width,
    ...rest
  }: Props) => {
    // When we have multiple icons of the same type on a page,
    // we need unique identifiers. On the profile page, there
    // were two close icons and the screen reader was confused
    // about their titles.
    const randomNum = Math.round(Math.random() * 100);
    const titleId = `${name}-${randomNum}`;

    return (
      <Box
        as="svg"
        className={className || ''}
        role="img"
        aria-labelledby={titleId}
        viewBox={viewBox}
        aria-hidden={isBoolean(ariaHidden) ? ariaHidden : true}
        fill={fill || 'none'}
        xmlns="http://www.w3.org/2000/svg"
        height={height || '100%'}
        width={width}
        {...rest}
      >
        {title && <title id={titleId}>{title}</title>}
        {children}
      </Box>
    );
  }
);

export default Svg;
